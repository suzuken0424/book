### 特集 1 シェルの基本大全

#### 第 1 章 シェルとターミナルの基本の使い方

##### シェルの種類

- Linux : bash
- macOS : zsh
- Windows10/11 : PowerShell

##### 知らなかったコマンド

- echo $SHELL：現在のシェルを表示
- chsh -s /bin/シェルの種類(bash など)：シェルを変更
- grep -v 文字列：文字列を含むものは除外
- awk {'操作(print $2 など)'}：行ごとに操作を行う
- ps：現在動作中のプロセスを表示する

##### 共通しているオプション

- -a : 全てを対象に
- -h : ヘルプを表示する

##### コマンドを組み合わせる

- cmd1 ; cmd2  
   cmd1 に続いて cmd2 を実行
- cmd1 && cmd2  
   cmd1 の実行に成功した場合に cmd2 を実行
- cmd1 || cmd2  
   cmd1 の実行に失敗した場合に cmd2 を実行

##### 便利機能

- tab キーを２回 : 補完機能
- history : コマンドの履歴を表示

#### 第 2 章 インタラクティブシェルで役立つ bash 機能

##### 知らなかったコマンド

- ?：空文字を含む 1 文字の全ての文字にマッチ
- […]：[]に囲まれた文字のいずれかにマッチ
- [^…]：[]に囲まれた文字以外にマッチ
- ${param}：変数 param の値に置換
- ${param:-word}：param が未設定 or 空文字の場合に word に置換。そうでない場合は param に置換
- ${param:=word}：param が未設定 or 空文字の場合に word に代入。そうでない場合は param に置換
- ${param:?word}：param が未設定 or 空文字の場合に word を展開した値を標準エラー出力。そうでない場合は param に置換
- ${param:+word}：param が未設定 or 空文字の場合に空文字に置換。そうでない場合は param に置換
- ${param:offset:length}：param を展開した値を offset から length 分取り出す
- ${!prefix\*}：prefix で始まる全ての変数を展開
- ${#param}：パラメータの値の長さ
- $((計算式))：計算結果を展開
- \*\*：累乗
- expr? expr1:expr2：expr が正(1)なら expr1 を実行。負(0)なら expr2 を実行
- !n；履歴番号 n 番目を表示
- !-n：n 個前の履歴を表示
- !!：1 つ前の履歴を表示
- !string：最近の string で始まるコマンドを表示
- !?string：最近の string を含むコマンドを表示
- !#string：今まで打ち込んだ以外のコマンドを表示

##### 履歴展開の単語指示子

- \*：履歴の 0 番目を除く全て
- ^：履歴の最初
- $：履歴の最後
- x-y：履歴の x 番目から y 番目
- 履歴展開の修飾子
- h：ファイル名のパス名のディレクトリ部のみ表示
- t：ファイル名のみ表示
- r：拡張子を取り除いたベース名のみ表示
- e：拡張子のみ表示
- xargs コマンド
- -n 数字：コマンドに渡す引数の最大値
- -I 文字列：指定した文字列を全て、標準入力から読み込んだ文字列に置き換える
- -0：入力文字列の区切りを\0 とする

#### 3 章 シェルスクリプトの使い方

##### 文法

- ${}：変数に表示
- 変数名=値：変数に代入
- If の構文例  
   if[n1 -gt n2]; then  
   fi

##### 条件判定

- n1 -eq -n2 or n1 = n2：n1 と n2 が等しければ真
- n1 -ne -n2 or n1 != n2：n1 と n2 が等しくなければ真
- n1 -lt -n2：n1<n2
- n1 -le -n2：n1<=n2
- n1 -gt -n2：n1>n2
- n1 -ge -n2：n1=>n2
- !：条件結果を反転する
- case の構文例  
   case “$input” in  
   esac
- for の構文例  
   for((i = 0; i <= 10; i++)); do  
   done
- while の構文例  
   while [ $i -lt 2 ]; do  
   done
- 関数の構文例  
   function reda_test_txt() {  
   }

##### 安全対策

- シェルスクリプト開始時に set -euo pipefail  
   「エラー発生時」と「未定義変数の使用時」にシェルスクリプトを停止させる
- ShellCheck の使用  
   危険なスクリプト実装ミスを指摘してくれる

#### 4 章 シェルを理解してカッコよく使おう

##### ログインシェルとインタラクティブシェルの違い

ログインシェルはログイン後に

- 環境変数を設定する
- ログイン時にのみ実施したい処理を行う

ログインシェルは/etc/profile を読み込み以下の順に読み込み可能なファイルを読み込む

1.  ~/.bash_profile
2.  ~/.bash_login
3.  ~/.profile

インタラクティブシェルは以下のものを読み込む

- /etc/bash.bashrc
- ~/.bashrc

#### 5 章 macOS におけるシェル＆コマンド

##### Bash3 の起動時に zsh をつけえとのメッセージを消す

1.  vi ~/.bash_profile で以下を追加
2.  export BASH_SILENCE_DEPRECATION_WARNING=1

##### bash5 の導入とログインシェルの変更

<div class="hcb_wrap">
        % brew install bash
        % sudo sh -c 'echo /user/local/bin/bash >> /etc/shells'
        % brew install bash

</div>

一旦ターミナルを再起動

&nbsp;bash --version でバージョンが 5 になっていれば OK

<figure class="wp-block-image size-full">![](https://blog3.key-p.com/suzuki/wp-content/uploads/2022/06/スクリーンショット-2022-06-04-12.49.32.png)</figure>

#### Appendix

##### bash のカスタマイズ

##### 時間を表示

<div class="hcb_wrap">
        % echo 'PS1="[\u@\h \T \w]\$ "' >> ~/.bashrc

</div>

.bash_profile に以下を追加し.bashrc を起動時に読み込むようにする

<div class="hcb_wrap">
        if [ -f ~/.bashrc ] ; then
           source ~/.bashrc
        fi

</div>

PS1 は bash が入力を受け付ける際に画面へ出力する文字列を指定できる

- \u：実行ユーザ名
- \h：実行ホスト名
- \T：現在時刻
- \w：カレントディレクトリへのパス

カスタマイズ結果

<figure class="wp-block-image size-full">![](https://blog3.key-p.com/suzuki/wp-content/uploads/2022/06/スクリーンショット-2022-06-04-12.49.56-1.png)</figure>

##### dotfiles を git で管理してみる

.bashrc にアクセストークンなどを記載している場合は対策をしなければいけないようだが、自分のファイルにはなかったので一旦飛ばす

<div class="hcb_wrap">
        % mkdir ~/dotfiles
        % cp ~/.bashrc ~/dotfiles
        % cd ~/dotfiles
        % git init
        % git add .bashrc
        % git commit -m ".bashrcを追加"
        % git remote add origin 新しく作ったリポジトリurl
        % git push origin master
        % rm ~/.bashrc
        % ln -s ~/dotfiles/.bashrc ~/.bashrc

</div>

#### 特集 1 の感想

インフラ研修でシェルを少し触ったのだが、プログラミングと少し違うところがあるので、慣れるまでは難しそうだと思った。  
記載されていたコマンドや bash のカスタマイズを自宅の mac でできるのを確認できたので、実際にいつも使っている mac でもしてみたい。

### **特集 2** Amazon RDS 導入ガイド

#### 第 1 章 RDBM と NoSQL の違い

ACID 特性とは

- Atomicity：1 つのトランザクションにまとめられた処理を全て実行するかしないか
- Consisitency：処理結果が条件や制約を守る
- Isolation：処理の途中で外から干渉できない
- Durability：処理が完了した時点で結果を永続的に保存する

Base 特性

- Basically Available：基本的に利用可能
- Soft-state：一貫性や整合性が厳密でない
- Eventual consistency：最終的には整合性がある。一時的な不整合は許容

RDBMS と NoSQL の違い

RDBMS  
ACID 特性に基づいて実装されている

メリット

- データの一貫性が保証されている
- SQL により複雑な操作が可能

デメリット

- 分散管理時にデータの書き込みが分散できない  
   → 複数のサーバーに分散させてデータを管理した場合、読取りは複数のサーバーで同時に読取りできるが、書込み時は一貫性を保つために分散した書き込みができない
- データが大規模になると処理速度が落ちる  
   → データ量が膨大になるとデータの整合性を保つための更新処理に時間がかかるから？

NoSQL  
Base 特性に基づいて実装されている

メリット

- 分散管理に適している  
   →RDBMS のように一貫性を保つ必要がないため書き込み・読み込みが分散できる
- 大容量データでも高速に処理できる  
   → 貫性を保証していないので、大量のデータでも高速に処理できる

デメリット

- データの一貫性が保証されていない
- SQL により複雑な操作ができない

#### 第２章 Amazon RDS 導入ガイド

Amazon RDS とは AWS が RDB の管理を行なってくれるサービス

- MySQL、MariaDB、 PostgreSQL、Microsoft SQL Server、Oracle Database  
   →RDS アーキテクチャ
- Amazon Aurora  
   →Aurora アーキテクチャ

##### RDS アーキテクチャ

まずプライマリサーバ下の EBS・EBS mirror にデータを書き込み  
次にスタンバイサーバにデータを送り、EBS・EBS mirror にデータを書き込む  
もしプライマリサーバが停止した場合にはスタンバイサーバに切り替えサービスを継続する

<!-- wp:image {"id":964,"sizeSlug":"full","linkDestination":"none"} -->

<figure class="wp-block-image size-full">![](https://blog3.key-p.com/suzuki/wp-content/uploads/2022/06/スクリーンショット-2022-06-04-18.41.33-1.png)</figure>

##### Aurora アーキテクチャ

まず更新ログをストレージサーバに転送し、６ヶ所のうち４カ所で成功すると完了  
ストレージサーバは受信した更新ログを利用してデータを更新する

<figure class="wp-block-image size-full">![](https://blog3.key-p.com/suzuki/wp-content/uploads/2022/06/スクリーンショット-2022-06-04-19.05.48-1.png)</figure>

#### 第３章 DynamoDB の強みとその活かし方

DynamoDB とはキーバリュー型の NoSQL データベース

##### DynamoDB 独自の用語

- テーブル：RDBMS のテーブルに相当する概念
- アイテム：RDBMS の行に相当する概念
- 属性：RDBMS の列に相当する概念
- パーティションキー：  
   処理を行うサーバを選択するキー  
   ソートキーが指定されなかった場合、一意である必要がある
- ソートキー：パーティションキーの中でデータを並べ替えるためのキー
- ローカルセカンダリインデックス：ソートキーと異なる追加の並び替えを行うキー
- グローバルセカンダリインデックス：アイテムのパーティションキーをまたいで検索するためのキー
- キャパシティユニット：1 秒あたりに処理可能な値
- オペレーション：アイテムに対する操作

##### DynamoDB が適した要件

- 大規模なアクセスが想定される場合
- ユーザ ID などでパーティションキーを分散できる場合
- IoT など多数のデバイスから書き込み/読み込みが発生する場合
- Amplify などの web フレームワークと組み合わせる場合

#### 特集 2 の感想

RDBMS と NoSQL の違いをある程度把握することはできた。

それぞれのメリットやデメリットの理由も調べたりしたのだが、いまいち確信が持てなかったので誰かに聞くなりしたい。

DynamoDB 独自の用語も把握ができたので、実際に構築する際は少しスムーズに構築できそうだと思う。

### **特集 3 不思議の国の SE 用語**

知っている単語もあったので、知らなもののみピックアップ

#### 動詞編

- 渡す・投げる：データを送信すること。渡すはデータの形式に気を使っている。投げるは大まか
- 引く：DNS レコードを問い合わせること
- 食べる：データを取り込ませること
- 喋る：あるプロトコルに従ってデータの送受信すること
- キックする：ジョブスケジューラがジョブやコマンドを実行する
- 張り付く：CPU やメモリなどのリソース使用率が高い水準で推移し続けること
- 掘る：ディレクトリを作成し、階層を深くすること
- 焼く：データを光学メディアに書き込むこと
- 枯れる：不具合が出尽くすこと
- 倒す：方針を選択すること
- サチる：リソース使用量が高まり、残りがなくなること

#### 名詞編

- ゾンビ：プロセスの処理が完了し、何もしていないのに残っているプロセス
- 突合：データを突き合わせること
- ポンチ絵・マンガ：資料中にある補助的な挿絵
- ペライチ：すぐに作れる簡単な資料
- マサカリ：技術的/学術的正当性に基づいた、発表などに対するぐうの音も出ない正論

#### 会議ワード

- 1.0：1.0 人月または 100%のこと
- 人格：立場のこと

#### 特集 3 の感想

インフラ研修時に澤口さんが言っていた「喋る」の謎が解明され、今になって言っている意味がわかった。

ほとんどが文脈で判断できそうだが、1.0 など知らないとわからないのものあるので、頭の片隅に記憶しておきたい。

渡すと投げるに微妙な違いあるのを初めて知ったのだが、意外と仕事中に使いこなせていたと思うので、日本語って面白いなと思った。
